var DATE_FORMAT="dd-mm-yyyy";var NO_IMAGE=web.host+"static/img/no-images.jpg";var Site={Host:web.host,IsValidEmail:function(e){var t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return t.test(e)},IsValidYear:function(e){var t=true;e=e+"";e=e.replace(new RegExp("[^0-9]","gi"),"");if(e.length!=4){t=false}return t},IsValidPostalCode:function(e){var t=true;e=e+"";e=e.replace(new RegExp("[^0-9]","gi"),"");if(e.length!=5){t=false}return t},GetTimeFromString:function(e){e=$.trim(e);if(e==""){return new Date}var t=new Date;var n=e.split("-");if(n[2]!=null&&n[2].length==4){t=new Date(n[2]+"-"+n[1]+"-"+n[0])}return t},SwapYearDay:function(e){var t=Site.GetTimeFromString(e);var n=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate();return n},Form:{InlineWarning:function(e){e.parent("td").append('<div class="CntWarning">'+e.attr("alt")+"</div>")},Start:function(e){var t=jQuery("#"+e+" input");for(var n=0;n<t.length;n++){if(t.eq(n).hasClass("datepicker")){t.eq(n).datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,yearRange:"c-20:c+10"})}else if(t.eq(n).hasClass("integer")||t.eq(n).hasClass("postalcode")){t.eq(n).keyup(function(e){var t=jQuery(this).val();t=t.replace(new RegExp("[^0-9.]","gi"),"");if(e.keyCode==16||e.keyCode==17||e.keyCode==18||e.ctrlKey||e.shiftKey){return true}jQuery(this).val(t)})}else if(t.eq(n).hasClass("alphabet")){t.eq(n).keyup(function(e){var t=jQuery(this).val();t=t.replace(new RegExp("[^a-z ]","gi"),"");if(e.keyCode==16||e.keyCode==17||e.keyCode==18||e.ctrlKey||e.shiftKey){return true}jQuery(this).val(t)})}else if(t.eq(n).hasClass("float")){t.eq(n).keyup(function(e){var t=jQuery(this).val();t=t.replace(new RegExp("[^0-9.]","gi"),"");if(e.keyCode==16||e.keyCode==17||e.keyCode==18||e.ctrlKey||e.shiftKey){return true}jQuery(this).val(t)})}}},Validation:function(e,t){t.Inline=t.Inline==null?false:t.Inline;var n=[];jQuery(".CntWarning").remove();var r=jQuery("#"+e+" input");for(var i=0;i<r.length;i++){r.eq(i).removeClass("ui-state-highlight");if(r.eq(i).hasClass("required")){var s=jQuery.trim(r.eq(i).val());if(s==""){r.eq(i).addClass("ui-state-highlight");n[n.length]=r.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(r.eq(i))}}if(r.eq(i).hasClass("integer")||r.eq(i).hasClass("datepicker")){var s=jQuery.trim(r.eq(i).val());var o=s.replace(new RegExp("[^0-9-]","gi"),"");if(s!=o){r.eq(i).addClass("ui-state-highlight");n[n.length]=r.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(r.eq(i))}}if(r.eq(i).hasClass("datepicker")){var u=true;var s=jQuery.trim(r.eq(i).val());var a=s.split("-");if(s.length==0){u=true}else if(a.length!=3){u=false}else if(a[0]==""||a[1]==""||a[2]==""){u=false}if(!u){r.eq(i).addClass("ui-state-highlight");if(t.Inline)Site.Form.InlineWarning(r.eq(i));n[n.length]=r.eq(i).attr("alt")}}if(r.eq(i).hasClass("email")&&!Site.IsValidEmail(r.eq(i).val())){if(r.eq(i).val()!=""){r.eq(i).addClass("ui-state-highlight");n[n.length]=r.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(r.eq(i))}}if(r.eq(i).hasClass("postalcode")&&r.eq(i).val().length!=0&&r.eq(i).val().length!=5){r.eq(i).addClass("ui-state-highlight");n[n.length]=r.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(r.eq(i))}if(r.eq(i).hasClass("year")&&r.eq(i).val().length!=0&&r.eq(i).val().length!=4){r.eq(i).addClass("ui-state-highlight");n[n.length]=r.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(r.eq(i))}}var f=jQuery("#"+e+" select");for(var i=0;i<f.length;i++){if(f.eq(i).hasClass("required")&&(f.eq(i).val()==""||f.eq(i).val()=="-")){f.eq(i).addClass("ui-state-highlight");n[n.length]=f.eq(i).attr("alt");if(t.Inline)Site.Form.InlineWarning(f.eq(i))}else{f.eq(i).removeClass("ui-state-highlight")}}var l=jQuery("#"+e+" textarea");for(var i=0;i<l.length;i++){var s=l.eq(i).val();s=jQuery.trim(s);if(l.eq(i).hasClass("required")&&l.eq(i).val()==""){l.eq(i).addClass("ui-state-highlight");n[n.length]=l.eq(i).attr("alt")}else{l.eq(i).removeClass("ui-state-highlight")}}return n},GetValue:function(e){var t=e.substr(0,1);if(!Func.InArray(t,[".","#"])){e="#"+e}var n=Object();var r=function(e,t,n){if(typeof t=="undefined"){return e}else if(t.length<3){e[t]=n;return e}var r=t.substr(t.length-2,2);if(r=="[]"){var i=t.replace(r,"");if(e[i]==null){e[i]=[]}e[i].push(n)}else{e[t]=n}return e};var i=jQuery(e+" input, "+e+" select, "+e+" textarea");for(var s=0;s<i.length;s++){var o=i.eq(s).attr("name");var u=i.eq(s).val();if(i.eq(s).attr("type")=="checkbox"){var a=i.eq(s).attr("checked");if(typeof a=="string"&&a=="checked"){n=r(n,o,u)}else{n=r(n,o,0)}}else{n=r(n,o,u)}}return n}}};var Func={ArrayToJson:function(e){var t="";for(var n=0;n<e.length;n++){t=t.length==0?Func.ObjectToJson(e[n]):t+","+Func.ObjectToJson(e[n])}return"["+t+"]"},InArray:function(e,t){var n=false;for(var r=0;r<t.length;r++){if(e==t[r]){n=true;break}}return n},IsEmpty:function(e){var t=false;if(e==null||e==0){t=true}else if(typeof e=="string"){e=Func.Trim(e);if(e.length==0){t=true}}return t},ObjectToJson:function(e){var t="";for(var n in e){if(e.hasOwnProperty(n)){if(e[n]!=null){t+=t.length==0?t:",";t+='"'+n+'":"'+e[n]+'"'}}}t="{"+t+"}";return t},SwapDate:function(e){if(e==null){return""}var t=e.split("-");if(t.length!=3){return""}return t[2]+"-"+t[1]+"-"+t[0]},Trim:function(e){return e.replace(/^\s+|\s+$/g,"")},GetName:function(e){var t=e.trim().replace(new RegExp(/[^0-9a-z]+/gi),"-").toLowerCase();t=t.replace(new RegExp(/^-/gi),"").toLowerCase();t=t.replace(new RegExp(/-$/gi),"").toLowerCase();return t},GetStringFromDate:function(e){if(e==null){return""}else if(typeof e=="string"){return e}var t=e.getDate();var n=t.toString().length==1?"0"+t:t;var r=e.getMonth()+1;var i=r.toString().length==1?"0"+r:r;var s=n+"-"+i+"-"+e.getFullYear();return s},InitForm:function(e){$(e.Container+" .datepicker").datepicker({format:DATE_FORMAT});$(e.Container+" .tinymce").tinymce({script_url:"../../../static/lib/tinymce/jscripts/tiny_mce/tiny_mce.js",theme:"advanced",plugins:"autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,advlist",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,sub,sup,|,charmap,iespell,media,advhr,|,fullscreen",theme_advanced_buttons2:"cut,copy,paste,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,image,code,|,forecolor,backcolor",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,template_external_list_url:"lists/template_list.js",external_link_list_url:"lists/link_list.js",external_image_list_url:"lists/image_list.js",media_external_list_url:"lists/media_list.js",template_replace_values:{username:"Some User",staffid:"991234"}});$(e.Container+" form").validate({onkeyup:false,errorClass:"error",validClass:"valid",highlight:function(e){$(e).closest("div").addClass("f_error")},unhighlight:function(e){$(e).closest("div").removeClass("f_error")},errorPlacement:function(e,t){$(t).closest("div").append(e)},rules:e.rule});$(e.Container+" [rel=twipsy]").focus(function(){if($(this).data("placement")==null){$(this).attr("data-placement","right")}if($(this).data("original-title")==null){$(this).attr("data-original-title",$(this).attr("placeholder"))}$(this).twipsy("show")});$(e.Container+" [rel=twipsy]").blur(function(){$(this).twipsy("hide")})},ajax:function(p){p.is_json=p.is_json==null?1:p.is_json;$.ajax({type:"POST",url:p.url,data:p.param,success:function(data){if(p.is_json==1){eval("var result = "+data);p.callback(result)}else{p.callback(data)}}})},show_notice:function(e){e.title=e.title==null?"Message":e.title;e.text=e.text==null?"-":e.text;$(".gritter-close").click();$.gritter.add({title:e.title,text:e.text,sticky:true,time:3e3});setTimeout(function(){var e=$(".gritter-item-wrapper").last().attr("id");$("#"+e).find(".gritter-close").click()},3e3)}}